import{E as je,R as i,H as Te,j as T,N as Ae,o as _e,f as Ne,e as te,r as Le,I as Ie,_ as We,J as Ue}from"./index-5cb102fc.js";import{r as Me}from"./features-fedf4e3f.js";var le={exports:{}},De="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",qe=De,Be=qe;function pe(){}function fe(){}fe.resetWarningCache=pe;var Fe=function(){function r(n,o,a,c,m,s){if(s!==Be){var C=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw C.name="Invariant Violation",C}}r.isRequired=r;function e(){return r}var t={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:e,element:r,elementType:r,instanceOf:e,node:r,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:fe,resetWarningCache:pe};return t.PropTypes=t,t};le.exports=Fe();var $e=le.exports;const u=je($e);function re(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(r,o).enumerable})),t.push.apply(t,n)}return t}function ne(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?re(Object(t),!0).forEach(function(n){de(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):re(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function F(r){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?F=function(e){return typeof e}:F=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},F(r)}function de(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function $(r,e){return Ke(r)||Ye(r,e)||Ve(r,e)||Ge()}function Ke(r){if(Array.isArray(r))return r}function Ye(r,e){var t=r&&(typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"]);if(t!=null){var n=[],o=!0,a=!1,c,m;try{for(t=t.call(r);!(o=(c=t.next()).done)&&(n.push(c.value),!(e&&n.length===e));o=!0);}catch(s){a=!0,m=s}finally{try{!o&&t.return!=null&&t.return()}finally{if(a)throw m}}return n}}function Ve(r,e){if(r){if(typeof r=="string")return oe(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);if(t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set")return Array.from(r);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return oe(r,e)}}function oe(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}function Ge(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var H=function(e){var t=i.useRef(e);return i.useEffect(function(){t.current=e},[e]),t.current},A=function(e){return e!==null&&F(e)==="object"},He=function(e){return A(e)&&typeof e.then=="function"},Je=function(e){return A(e)&&typeof e.elements=="function"&&typeof e.createToken=="function"&&typeof e.createPaymentMethod=="function"&&typeof e.confirmCardPayment=="function"},ae="[object Object]",Xe=function r(e,t){if(!A(e)||!A(t))return e===t;var n=Array.isArray(e),o=Array.isArray(t);if(n!==o)return!1;var a=Object.prototype.toString.call(e)===ae,c=Object.prototype.toString.call(t)===ae;if(a!==c)return!1;if(!a&&!n)return e===t;var m=Object.keys(e),s=Object.keys(t);if(m.length!==s.length)return!1;for(var C={},E=0;E<m.length;E+=1)C[m[E]]=!0;for(var g=0;g<s.length;g+=1)C[s[g]]=!0;var y=Object.keys(C);if(y.length!==m.length)return!1;var b=e,w=t,S=function(x){return r(b[x],w[x])};return y.every(S)},me=function(e,t,n){return A(e)?Object.keys(e).reduce(function(o,a){var c=!A(t)||!Xe(e[a],t[a]);return n.includes(a)?(c&&console.warn("Unsupported prop change: options.".concat(a," is not a mutable property.")),o):c?ne(ne({},o||{}),{},de({},a,e[a])):o},null):null},ve="Invalid prop `stripe` supplied to `Elements`. We recommend using the `loadStripe` utility from `@stripe/stripe-js`. See https://stripe.com/docs/stripe-js/react#elements-props-stripe for details.",se=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ve;if(e===null||Je(e))return e;throw new Error(t)},ze=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ve;if(He(e))return{tag:"async",stripePromise:Promise.resolve(e).then(function(o){return se(o,t)})};var n=se(e,t);return n===null?{tag:"empty"}:{tag:"sync",stripe:n}},Qe=function(e){!e||!e._registerWrapper||!e.registerAppInfo||(e._registerWrapper({name:"react-stripe-js",version:"2.4.0"}),e.registerAppInfo({name:"react-stripe-js",version:"2.4.0",url:"https://stripe.com/docs/stripe-js/react"}))},he=i.createContext(null);he.displayName="CustomCheckoutSdkContext";var Ze=function(e,t){if(!e)throw new Error("Could not find CustomCheckoutProvider context; You need to wrap the part of your app that ".concat(t," in an <CustomCheckoutProvider> provider."));return e},et=i.createContext(null);et.displayName="CustomCheckoutContext";u.any,u.shape({clientSecret:u.string.isRequired,elementsOptions:u.object}).isRequired;var J=function(e){var t=i.useContext(he),n=i.useContext(K);if(t&&n)throw new Error("You cannot wrap the part of your app that ".concat(e," in both <CustomCheckoutProvider> and <Elements> providers."));return t?Ze(t,e):Ce(n,e)},K=i.createContext(null);K.displayName="ElementsContext";var Ce=function(e,t){if(!e)throw new Error("Could not find Elements context; You need to wrap the part of your app that ".concat(t," in an <Elements> provider."));return e},X=i.createContext(null);X.displayName="CartElementContext";var tt=function(e,t){if(!e)throw new Error("Could not find Elements context; You need to wrap the part of your app that ".concat(t," in an <Elements> provider."));return e},ye=function(e){var t=e.stripe,n=e.options,o=e.children,a=i.useMemo(function(){return ze(t)},[t]),c=i.useState(null),m=$(c,2),s=m[0],C=m[1],E=i.useState(null),g=$(E,2),y=g[0],b=g[1],w=i.useState(function(){return{stripe:a.tag==="sync"?a.stripe:null,elements:a.tag==="sync"?a.stripe.elements(n):null}}),S=$(w,2),l=S[0],x=S[1];i.useEffect(function(){var k=!0,L=function(I){x(function(W){return W.stripe?W:{stripe:I,elements:I.elements(n)}})};return a.tag==="async"&&!l.stripe?a.stripePromise.then(function(j){j&&k&&L(j)}):a.tag==="sync"&&!l.stripe&&L(a.stripe),function(){k=!1}},[a,l,n]);var O=H(t);i.useEffect(function(){O!==null&&O!==t&&console.warn("Unsupported prop change on Elements: You cannot change the `stripe` prop after setting it.")},[O,t]);var R=H(n);return i.useEffect(function(){if(l.elements){var k=me(n,R,["clientSecret","fonts"]);k&&l.elements.update(k)}},[n,R,l.elements]),i.useEffect(function(){Qe(l.stripe)},[l.stripe]),i.createElement(K.Provider,{value:l},i.createElement(X.Provider,{value:{cart:s,setCart:C,cartState:y,setCartState:b}},o))};ye.propTypes={stripe:u.any,options:u.object};var rt=function(e){var t=i.useContext(K);return Ce(t,e)},nt={cart:null,cartState:null,setCart:function(){},setCartState:function(){}},ie=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=i.useContext(X);return t?nt:tt(n,e)},ot=function(){var e=rt("calls useElements()"),t=e.elements;return t},at=function(){var e=J("calls useStripe()"),t=e.stripe;return t};u.func.isRequired;var h=function(e,t,n){var o=!!n,a=i.useRef(n);i.useEffect(function(){a.current=n},[n]),i.useEffect(function(){if(!o||!e)return function(){};var c=function(){a.current&&a.current.apply(a,arguments)};return e.on(t,c),function(){e.off(t,c)}},[o,t,e,a])},st=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},p=function(e,t){var n="".concat(st(e),"Element"),o=function(s){var C=s.id,E=s.className,g=s.options,y=g===void 0?{}:g,b=s.onBlur,w=s.onFocus,S=s.onReady,l=s.onChange,x=s.onEscape,O=s.onClick,R=s.onLoadError,k=s.onLoaderStart,L=s.onNetworksChange,j=s.onCheckout,I=s.onLineItemClick,W=s.onConfirm,be=s.onCancel,ke=s.onShippingAddressChange,xe=s.onShippingRateChange,_=J("mounts <".concat(n,">")),U="elements"in _?_.elements:null,M="customCheckoutSdk"in _?_.customCheckoutSdk:null,Pe=i.useState(null),z=$(Pe,2),v=z[0],we=z[1],P=i.useRef(null),Y=i.useRef(null),Q=ie("mounts <".concat(n,">"),"customCheckoutSdk"in _),V=Q.setCart,G=Q.setCartState;h(v,"blur",b),h(v,"focus",w),h(v,"escape",x),h(v,"click",O),h(v,"loaderror",R),h(v,"loaderstart",k),h(v,"networkschange",L),h(v,"lineitemclick",I),h(v,"confirm",W),h(v,"cancel",be),h(v,"shippingaddresschange",ke),h(v,"shippingratechange",xe);var D;e==="cart"?D=function(ee){G(ee),S&&S(ee)}:S&&(e==="expressCheckout"?D=S:D=function(){S(v)}),h(v,"ready",D);var Oe=e==="cart"?function(d){G(d),l&&l(d)}:l;h(v,"change",Oe);var Re=e==="cart"?function(d){G(d),j&&j(d)}:j;h(v,"checkout",Re),i.useLayoutEffect(function(){if(P.current===null&&Y.current!==null&&(U||M)){var d=null;M?d=M.createElement(e,y):U&&(d=U.create(e,y)),e==="cart"&&V&&V(d),P.current=d,we(d),d&&d.mount(Y.current)}},[U,M,y,V]);var Z=H(y);return i.useEffect(function(){if(P.current){var d=me(y,Z,["paymentRequest"]);d&&P.current.update(d)}},[y,Z]),i.useLayoutEffect(function(){return function(){if(P.current&&typeof P.current.destroy=="function")try{P.current.destroy(),P.current=null}catch{}}},[]),i.createElement("div",{id:C,className:E,ref:Y})},a=function(s){var C=J("mounts <".concat(n,">"));ie("mounts <".concat(n,">"),"customCheckoutSdk"in C);var E=s.id,g=s.className;return i.createElement("div",{id:E,className:g})},c=t?a:o;return c.propTypes={id:u.string,className:u.string,onChange:u.func,onBlur:u.func,onFocus:u.func,onReady:u.func,onEscape:u.func,onClick:u.func,onLoadError:u.func,onLoaderStart:u.func,onNetworksChange:u.func,onCheckout:u.func,onLineItemClick:u.func,onConfirm:u.func,onCancel:u.func,onShippingAddressChange:u.func,onShippingRateChange:u.func,options:u.object},c.displayName=n,c.__elementType=e,c},f=typeof window>"u",it=i.createContext(null);it.displayName="EmbeddedCheckoutProviderContext";p("auBankAccount",f);p("card",f);p("cardNumber",f);p("cardExpiry",f);p("cardCvc",f);p("fpxBank",f);p("iban",f);p("idealBank",f);p("p24Bank",f);p("epsBank",f);var ut=p("payment",f);p("expressCheckout",f);p("paymentRequestButton",f);p("linkAuthentication",f);p("address",f);p("shippingAddress",f);p("cart",f);p("paymentMethodMessaging",f);p("affirmMessage",f);p("afterpayClearpayMessage",f);var ge="https://js.stripe.com/v3",ct=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,ue="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",lt=function(){for(var e=document.querySelectorAll('script[src^="'.concat(ge,'"]')),t=0;t<e.length;t++){var n=e[t];if(ct.test(n.src))return n}return null},ce=function(e){var t=e&&!e.advancedFraudSignals?"?advancedFraudSignals=false":"",n=document.createElement("script");n.src="".concat(ge).concat(t);var o=document.head||document.body;if(!o)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return o.appendChild(n),n},pt=function(e,t){!e||!e._registerWrapper||e._registerWrapper({name:"stripe-js",version:"2.2.1",startTime:t})},N=null,q=null,B=null,ft=function(e){return function(){e(new Error("Failed to load Stripe.js"))}},dt=function(e,t){return function(){window.Stripe?e(window.Stripe):t(new Error("Stripe.js not available"))}},mt=function(e){return N!==null?N:(N=new Promise(function(t,n){if(typeof window>"u"||typeof document>"u"){t(null);return}if(window.Stripe&&e&&console.warn(ue),window.Stripe){t(window.Stripe);return}try{var o=lt();if(o&&e)console.warn(ue);else if(!o)o=ce(e);else if(o&&B!==null&&q!==null){var a;o.removeEventListener("load",B),o.removeEventListener("error",q),(a=o.parentNode)===null||a===void 0||a.removeChild(o),o=ce(e)}B=dt(t,n),q=ft(n),o.addEventListener("load",B),o.addEventListener("error",q)}catch(c){n(c);return}}),N.catch(function(t){return N=null,Promise.reject(t)}))},vt=function(e,t,n){if(e===null)return null;var o=e.apply(void 0,t);return pt(o,n),o},Se=Promise.resolve().then(function(){return mt(null)}),Ee=!1;Se.catch(function(r){Ee||console.warn(r)});var ht=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];Ee=!0;var o=Date.now();return Se.then(function(a){return vt(a,t,o)})};const Ct=ht("pk_test_51Op48IBxsJkAdKVPtLMV8f1koRhpRoPfv9kuzMit6mNk0q5KMbdechK91xGmMDQ88t5FlD3NjK7wKkg8qldxX2iX001HZvyGAn"),yt=()=>{const r=at(),e=ot(),t=_e(),n=Ne(),{user:o}=te(l=>l.userReducer),{shippingInfo:a,cartItems:c,subtotal:m,tax:s,discount:C,shippingCharges:E,total:g}=te(l=>l.cartReducer),[y,b]=Le.useState(!1),[w]=Ie(),S=async l=>{if(l.preventDefault(),!r||!e)return;b(!0);const x={shippingInfo:a,orderItems:c,subtotal:m,tax:s,discount:C,shippingCharges:E,total:g,user:o==null?void 0:o._id},{paymentIntent:O,error:R}=await r.confirmPayment({elements:e,confirmParams:{return_url:window.location.origin},redirect:"if_required"});if(R)return b(!1),We.error(R.message||"Something Went Wrong");if(O.status==="succeeded"){const k=await w(x);n(Ue()),Me(k,t,"/orders")}b(!1)};return T.jsx("div",{className:"checkout-container",children:T.jsxs("form",{onSubmit:S,children:[T.jsx(ut,{}),T.jsx("button",{type:"submit",disabled:y,children:y?"Processing...":"Pay"})]})})},Et=()=>{const e=Te().state;return e?T.jsx(ye,{options:{clientSecret:e},stripe:Ct,children:T.jsx(yt,{})}):T.jsx(Ae,{to:"/shipping"})};export{Et as default};
